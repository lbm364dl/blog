{
  "hash": "30efe9ae0b1693012a69c176a6edff45",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Historic UK Meteorological & Climate Data\"\ndate: \"2025-03-16\"\ncategories: [tidytuesday]\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntuesdata <- tidytuesdayR::tt_load(\"2025-10-21\")\nhistoric_station_met <- tuesdata$historic_station_met |>\n  dplyr::mutate(year = as.integer(year))\nstation_meta <- tuesdata$station_meta |>\n  dplyr::mutate(opened = as.integer(opened))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhistoric_station_met\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 39,148 × 8\n   station    year month  tmax  tmin    af  rain   sun\n   <chr>     <int> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1 aberporth  1941     1    NA    NA    NA  74.7    NA\n 2 aberporth  1941     2    NA    NA    NA  69.1    NA\n 3 aberporth  1941     3    NA    NA    NA  76.2    NA\n 4 aberporth  1941     4    NA    NA    NA  33.7    NA\n 5 aberporth  1941     5    NA    NA    NA  51.3    NA\n 6 aberporth  1941     6    NA    NA    NA  25.7    NA\n 7 aberporth  1941     7    NA    NA    NA  53.9    NA\n 8 aberporth  1941     8    NA    NA    NA  91.8    NA\n 9 aberporth  1941     9    NA    NA    NA  25.5    NA\n10 aberporth  1941    10    NA    NA    NA 106.     NA\n# ℹ 39,138 more rows\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_meta\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 37 × 5\n   station      station_name        opened    lng   lat\n   <chr>        <chr>                <int>  <dbl> <dbl>\n 1 aberporth    Aberporth             1941 -4.57   52.1\n 2 armagh       Armagh                1853 -6.65   54.4\n 3 ballypatrick Ballypatrick Forest   1961 -6.15   55.2\n 4 bradford     Bradford              1908 -1.77   53.8\n 5 braemar      Braemar No 2          1959 -3.40   57.0\n 6 camborne     Camborne              1978 -5.33   50.2\n 7 cambridge    Cambridge Niab        1959  0.102  52.2\n 8 cardiff      Cardiff Bute Park     1977 -3.19   51.5\n 9 chivenor     Chivenor              1951 -4.15   51.1\n10 cwmystwyth   Cwmystwyth            1959 -3.80   52.4\n# ℹ 27 more rows\n```\n\n\n:::\n:::\n\n\n::: {.callout-note collapse=true}\n## When was the first station opened?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_meta |>\n  dplyr::slice_min(opened)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  station station_name opened   lng   lat\n  <chr>   <chr>         <int> <dbl> <dbl>\n1 armagh  Armagh         1853 -6.65  54.4\n2 oxford  Oxford         1853 -1.26  51.8\n```\n\n\n:::\n:::\n\n\nThis happened in 1853 with two stations opened in that year!\n:::\n\n::: {.callout-note collapse=true}\n## Which data was collected in that year?\n\n::: {.cell}\n\n```{.r .cell-code}\nstation_meta |>\n  dplyr::slice_min(opened) |>\n  dplyr::inner_join(\n    historic_station_met,\n    dplyr::join_by(station, opened == year)\n  ) |>\n  print(n = Inf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 24 × 11\n   station station_name opened   lng   lat month  tmax  tmin    af  rain   sun\n   <chr>   <chr>         <int> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>\n 1 armagh  Armagh         1853 -6.65  54.4     1  NA    NA      NA  57.3    NA\n 2 armagh  Armagh         1853 -6.65  54.4     2  NA    NA      NA  32.3    NA\n 3 armagh  Armagh         1853 -6.65  54.4     3  NA    NA      NA  65.5    NA\n 4 armagh  Armagh         1853 -6.65  54.4     4  NA    NA      NA  46.2    NA\n 5 armagh  Armagh         1853 -6.65  54.4     5  NA    NA      NA  13.2    NA\n 6 armagh  Armagh         1853 -6.65  54.4     6  NA    NA      NA  53.3    NA\n 7 armagh  Armagh         1853 -6.65  54.4     7  NA    NA      NA  78      NA\n 8 armagh  Armagh         1853 -6.65  54.4     8  NA    NA      NA  56.6    NA\n 9 armagh  Armagh         1853 -6.65  54.4     9  NA    NA      NA  24.5    NA\n10 armagh  Armagh         1853 -6.65  54.4    10  NA    NA      NA  94.8    NA\n11 armagh  Armagh         1853 -6.65  54.4    11  NA    NA      NA  75.5    NA\n12 armagh  Armagh         1853 -6.65  54.4    12  NA    NA      NA  39.1    NA\n13 oxford  Oxford         1853 -1.26  51.8     1   8.4   2.7     4  62.8    NA\n14 oxford  Oxford         1853 -1.26  51.8     2   3.2  -1.8    19  29.3    NA\n15 oxford  Oxford         1853 -1.26  51.8     3   7.7  -0.6    20  25.9    NA\n16 oxford  Oxford         1853 -1.26  51.8     4  12.6   4.5     0  60.1    NA\n17 oxford  Oxford         1853 -1.26  51.8     5  16.8   6.1     0  59.5    NA\n18 oxford  Oxford         1853 -1.26  51.8     6  20.1  10.7     0  82      NA\n19 oxford  Oxford         1853 -1.26  51.8     7  21.2  12.2     0  86.2    NA\n20 oxford  Oxford         1853 -1.26  51.8     8  20.2  10.8     0  72.3    NA\n21 oxford  Oxford         1853 -1.26  51.8     9  17.3   8.4     0  51.3    NA\n22 oxford  Oxford         1853 -1.26  51.8    10  13.9   7.4     0 102.     NA\n23 oxford  Oxford         1853 -1.26  51.8    11   8.7   2.3    10  49.6    NA\n24 oxford  Oxford         1853 -1.26  51.8    12   3.7  -1.3    19  10.7    NA\n```\n\n\n:::\n:::\n\n\nEven though two opened in that year, it seems the one from Oxford was better prepared, since it also measured temperature (in consequence, also number of air frost days in each month).\n:::\n\n::: {.callout-note collapse=true}\n## Can we visualize when the stations were opened in a map over time?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- station_meta |>\n  dplyr::mutate(year = opened) |>\n  tidyr::complete(station, year) |>\n  dplyr::arrange(station, opened) |>\n  tidyr::fill(everything(), .direction = \"down\") |>\n  dplyr::filter(year >= opened) |>\n  dplyr::mutate(\n    decade = ggplot2::cut_width(year, width = 10),\n    status = ifelse(year == opened, \"New\", \"Existed\")\n  ) |>\n  dplyr::slice_min(year, by = c(\"station\", \"decade\"))\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggmap::register_stadiamaps(key = Sys.getenv(\"STADIA_KEY\"))\n\nuk_map <- ggmap::get_stadiamap(\n  bbox = osmdata::getbb(\"United Kingdom\"),\n  zoom = 6,\n  maptype = \"stamen_watercolor\"\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nℹ © Stadia Maps © Stamen Design © OpenMapTiles © OpenStreetMap contributors.\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nuk_map |>\n  ggmap::ggmap() +\n  ggplot2::geom_point(data = data, ggplot2::aes(lng, lat, color = status)) +\n  ggplot2::facet_wrap(~decade) +\n  ggplot2::scale_color_manual(\n    values = c(\"Existed\" = \"gray60\", \"New\" = \"black\")\n  )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/solution-code-1.png){width=672}\n:::\n:::\n\n:::\n\n\n::: {.cell ref='solution-code'}\n\n:::\n\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}